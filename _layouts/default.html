<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/theme-switch.css' | relative_url }}?v={{ site.time | date: '%s' }}"> 
    <link rel="shortcut icon" type="image/png" href="{{ '/assets/images/shinris3n.png' | relative_url }}">

    {% seo %}
  </head>

  <body>
<header>
      <div class="container header-flex">
        <div class="header-text">
          <h1>
            <a href="{{ '/' | relative_url }}" class="brand-link" style="text-decoration:none;">
              {{ site.title }}
            </a>
          </h1>
          <h2>{{ site.description }}</h2>
          
          <p style="margin-top: 10px;">
            ðŸ‘Š <a href="{{ '/writeups' | relative_url }}" class="brand-link">Writeups</a> 
            ðŸ‘Š <a href="{{ '/news' | relative_url }}" class="brand-link">News</a> 
            ðŸ‘Š <a href="{{ '/resources' | relative_url }}" class="brand-link">Resources</a>
          </p>
        </div>

        <div class="header-logo-wrapper">
          <img src="{{ '/assets/images/ninpwn.png' | relative_url }}" alt="NINPWN Logo" class="header-brand-logo">
        </div>
      </div>
    </header>

    <div class="container">
      <a href="{{ '/' | relative_url }}">
        <img src="{{ '/assets/images/shinris3n_banner_transparent.png' | relative_url }}" width="25%" height="25%" alt="shinris3n" title="shinris3n home page link">
      </a>
      <section id="main_content">
        {{ content }}
      </section>
    </div>

    <button id="theme-toggle" onclick="toggleTheme()">
      Switch to Readability Mode
    </button>

    <script>
      // 1. Check Local Storage (User Preference)
      const currentTheme = localStorage.getItem('theme');
      
      // 2. Check URL Parameter (Professional Override)
      // Allows links like: yoursite.com/post?mode=readability
      const urlParams = new URLSearchParams(window.location.search);
      const forceReadability = urlParams.get('mode') === 'readability';

      const toggleBtn = document.getElementById('theme-toggle');
      
      // Logic: If Local Storage says "Readability" OR URL forces "Readability"
      if (currentTheme === 'readability-mode' || forceReadability) {
        document.body.classList.add('readability-mode');
        toggleBtn.innerText = "Switch to NINPWN Mode";
        
        // If forced via URL, save it so they stay in professional mode 
        // as they click around the site.
        if (forceReadability) {
          localStorage.setItem('theme', 'readability-mode');
        }
      } else {
        toggleBtn.innerText = "Switch to Readability Mode";
      }

      function toggleTheme() {
        const body = document.body;
        body.classList.toggle('readability-mode');
        
        if (body.classList.contains('readability-mode')) {
          localStorage.setItem('theme', 'readability-mode');
          toggleBtn.innerText = "Switch to NINPWN Mode";
        } else {
          localStorage.removeItem('theme');
          toggleBtn.innerText = "Switch to Readability Mode";
        }
      }
    </script>
    
  </body>
</html>
